<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 程式版本 = V1.000 -->
<mapper namespace="docrm.dao.DOCRM230M_">
	
	<select id="queryDOCRMT200" parameterType="HashMap" resultType="HashMap">
		SELECT DOCRMT200.PKNO,
			   DOCRMT200.MESS_NO,
			   DOCRMT200.DOCRM_NO,
			   DOCRMT200.TAX_TP,
			   DOCRMT200.DOCRM_TP,
			   DOCRMT200.ACP_CD,
			   DOCRMT200.RDC_NO,
			   DOCRMT200.VERIFY_NO,
			   DOCRMT200.APPLY_NM,
			   DOCRMT200.APPLY_IDN,
			   DOCRMT200.APPLY_SUBJECT,
			   DOCRMT200.APPLY_DATE,
			   DOCRMT200.LMT_DATE,
			   DOCRMT200.CPL_DATE,
			   DOCRMT200.MOBILE_NO,
			   DOCRMT200.EMAIL,
			   DOCRMT200.DOCRM_STUS,
			   DOCRMT200.MSG_STUS,
			   DOCRMT200.ADD_MK,
			   DOCRMT200.ADD_STUS,
			   DOCRMT200.ADD_CPL_DATE,
			   DOCRMT200.DOC_ORG_ID,
			   DOCRMT200.DOC_STF_NM,
			   DOCRMT200.CREATE_DATE,
			   DOCRMT200.CREATE_TIME,
			   DOCRMT200.CREATE_USER_ID,
			   DOCRMT200.UPDATE_DATE,
			   DOCRMT200.UPDATE_TIME,
			   DOCRMT200.UPDATE_USER_ID,
			   R1.PHRASE_TITLE AS TAX_TP_NM,
			   R2.PHRASE_TITLE AS DOCRM_STUS_NM,
			   R3.PHRASE_TITLE AS ACP_CD_NM,
			   R4.PHRASE_TITLE AS ADD_STUS_NM,
			   R5.DOCRM_TP_NM
		  FROM DOCRMT200 
		  LEFT JOIN DOCRMT850 R1 ON R1.PHRASE_KEY = DOCRMT200.TAX_TP AND R1.PHRASE_TYPE_KEY = 'TAX_TP'
		  LEFT JOIN DOCRMT850 R2 ON R2.PHRASE_KEY = DOCRMT200.DOCRM_STUS AND R2.PHRASE_TYPE_KEY = 'DOCRM_STUS'
		  LEFT JOIN DOCRMT850 R3 ON R3.PHRASE_KEY = DOCRMT200.ACP_CD AND R3.PHRASE_TYPE_KEY = 'ORG_ID'
		  LEFT JOIN DOCRMT850 R4 ON R4.PHRASE_KEY = IFNULL(DOCRMT200.ADD_STUS,'N') AND R4.PHRASE_TYPE_KEY = 'ADD_STUS'
		  LEFT JOIN DOCRMT820 R5 ON R5.TAX_TP = DOCRMT200.TAX_TP AND R5.DOCRM_TP = DOCRMT200.DOCRM_TP
		 WHERE ADD_MK = 'Y'
		   AND DOCRM_STUS <![CDATA[<>]]> '5'
		  		<if test="PKNO != null and PKNO != '' ">AND DOCRMT200.PKNO = #{PKNO}</if>
		  		<if test="MESS_NO != null and MESS_NO != '' ">AND DOCRMT200.MESS_NO = #{MESS_NO}</if>
		  		<if test="TAX_TP != null and TAX_TP != '' ">AND DOCRMT200.TAX_TP = #{TAX_TP}</if>
		  		<if test="DOCRM_NO != null and DOCRM_NO != '' ">AND DOCRMT200.DOCRM_NO = #{DOCRM_NO}</if>
		  		<if test="ADD_STUS != null and ADD_STUS != '' ">AND IFNULL(DOCRMT200.ADD_STUS,'N') = #{ADD_STUS}</if>
	</select>
	
	<select id="queryDOCRMT200N" parameterType="HashMap" resultType="HashMap">
		SELECT DOCRMT200.PKNO,
			   DOCRMT200.MESS_NO,
			   DOCRMT200.DOCRM_NO,
			   DOCRMT200.TAX_TP,
			   DOCRMT200.DOCRM_TP,
			   DOCRMT200.ACP_CD,
			   DOCRMT200.RDC_NO,
			   DOCRMT200.VERIFY_NO,
			   DOCRMT200.APPLY_NM,
			   DOCRMT200.APPLY_IDN,
			   DOCRMT200.APPLY_SUBJECT,
			   DOCRMT200.APPLY_DATE,
			   DOCRMT200.LMT_DATE,
			   DOCRMT200.CPL_DATE,
			   DOCRMT200.MOBILE_NO,
			   DOCRMT200.EMAIL,
			   DOCRMT200.DOCRM_STUS,
			   DOCRMT200.MSG_STUS,
			   DOCRMT200.ADD_MK,
			   DOCRMT200.ADD_STUS,
			   DOCRMT200.ADD_CPL_DATE,
			   DOCRMT200.DOC_ORG_ID,
			   DOCRMT200.DOC_STF_NM,
			   DOCRMT200.CREATE_DATE,
			   DOCRMT200.CREATE_TIME,
			   DOCRMT200.CREATE_USER_ID,
			   DOCRMT200.UPDATE_DATE,
			   DOCRMT200.UPDATE_TIME,
			   DOCRMT200.UPDATE_USER_ID,
			   R1.PHRASE_TITLE AS TAX_TP_NM,
			   R2.PHRASE_TITLE AS DOCRM_STUS_NM,
			   R3.PHRASE_TITLE AS DOC_ORG_ID_NM,
			   R4.DOCRM_TP_NM
		  FROM DOCRMT200 
		  LEFT JOIN DOCRMT850 R1 ON R1.PHRASE_KEY = DOCRMT200.TAX_TP AND R1.PHRASE_TYPE_KEY = 'TAX_TP'
		  LEFT JOIN DOCRMT850 R2 ON R2.PHRASE_KEY = DOCRMT200.DOCRM_STUS AND R2.PHRASE_TYPE_KEY = 'DOCRM_STUS'
		  LEFT JOIN DOCRMT850 R3 ON R3.PHRASE_KEY = DOCRMT200.DOC_ORG_ID AND R3.PHRASE_TYPE_KEY = 'ORG_ID'
		  LEFT JOIN DOCRMT820 R4 ON R4.TAX_TP = DOCRMT200.TAX_TP AND R4.DOCRM_TP = DOCRMT200.DOCRM_TP
		 WHERE IFNULL(DOCRMT200.ADD_MK,'N') = 'N'
		   AND DOCRM_STUS <![CDATA[<>]]> '5'
	</select>
	
	<select id="queryDOCRMT230" parameterType="HashMap" resultType="HashMap">
		SELECT DOCRMT230.PKNO,
		       DOCRMT230.DOCRM_NO,
		       DOCRMT230.MESS_NO,
		       DOCRMT230.DOC_TP,
		       DOCRMT230.ADD_STUS,
		       DOCRMT230.CPL_DATE,
		       DOCRMT230.UPDATE_DATE,
			   DOCRMT230.UPDATE_TIME,
			   DOCRMT230.UPDATE_USER_ID,
		       R1.PHRASE_TITLE AS ADD_STUS_NM
		  FROM DOCRMT230
		  LEFT JOIN DOCRMT850 R1 ON R1.PHRASE_KEY = DOCRMT230.ADD_STUS AND R1.PHRASE_TYPE_KEY = 'ADD_STUS'
         WHERE IFNULL(DOC_TP, '') <![CDATA[<>]]> ''
		 	<if test="DOCRM_NO != null and DOCRM_NO != '' ">AND DOCRMT230.DOCRM_NO = #{DOCRM_NO}</if>
		 	<if test="PKNO != null and PKNO != '' ">AND DOCRMT230.PKNO = #{PKNO}</if>
	</select>
	
	<select id="queryDOCRMT210" parameterType="HashMap" resultType="HashMap">
		SELECT MESS_NO,
		       DOCRM_NO,
		       FILE_NO,
		       SUBSTR(FILE_NM,15)  AS FILE_NM
		  FROM DOCRMT210
		 WHERE MESS_NO = #{MESS_NO}
		   AND DOC_TP = #{DOC_TP}
	</select>
</mapper>
