<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 程式版本 = V1.000 -->
<mapper namespace="docrm.dao.DOCRM730M_">

	<select id="queryDOCRMT730" parameterType="HashMap" resultType="HashMap">
				SELECT PHRASE_TITLE,
		(SELECT COUNT(*)
		FROM DOCRMT200 A
		LEFT JOIN DOCRMT850
		ON DOCRMT850.PHRASE_KEY = A.TAX_TP
		LEFT JOIN docrmt720
		ON DOCRMT720.DOCRM_NO = A.DOCRM_NO
		WHERE
		SUBSTR(A.CPL_DATE, 1, 5) = #{DATE}
		AND A.TAX_TP=DOCRMT200.TAX_TP
		<if test="DOC_ORG_ID != null and DOC_ORG_ID != ''">
			AND A.ACP_CD = #{DOC_ORG_ID}
		</if>
		<if test="TAX_TP != null and TAX_TP != ''">
			AND DOCRMT850.PHRASE_KEY = #{TAX_TP}
		</if>
		<if test="QUESTION_ID != null and QUESTION_ID != ''">
			AND DOCRMT720.QUESTION_ID = #{QUESTION_ID}
		</if>
		) AS Month_End,
		SUM(IFNULL(RESULT_ID1,0)) AS Month1,
		SUM(IFNULL(RESULT_ID2,0)) AS Month2,
		SUM(IFNULL(RESULT_ID3,0)) AS Month3,
		SUM(IFNULL(RESULT_ID4,0)) AS Month4,
		SUM(IFNULL(RESULT_ID5,0)) AS Month_Zero,
		SUM(IFNULL(RESULT_ID6,0)) AS Next_Month1,
		SUM(IFNULL(RESULT_ID7,0)) AS Next_Month2,
		SUM(IFNULL(RESULT_ID8,0)) AS Next_Month3,
		SUM(IFNULL(RESULT_ID9,0)) AS Next_Month4,
		(SELECT COUNT(*)
		FROM DOCRMT720, DOCRMT200 ,DOCRMT700
		WHERE DOCRMT720.DOCRM_NO = DOCRMT200.DOCRM_NO
		AND DOCRMT850.PHRASE_KEY = DOCRMT200.TAX_TP
		AND SUBSTR(DOCRMT720.RESPOND_DATE, 1, 5) = #{DATE}
		AND DOCRMT700.QUESTION_ID = docrmt720.QUESTION_ID
		<if test="QUESTION_ID != null and QUESTION_ID != ''">
			AND DOCRMT720.QUESTION_ID = #{QUESTION_ID}
		</if>
		<if test="DOC_ORG_ID != null and DOC_ORG_ID != ''">
			AND DOCRMT200.ACP_CD = #{DOC_ORG_ID}
		</if>
		<if test="TAX_TP != null and TAX_TP != ''">
			AND DOCRMT850.PHRASE_KEY = #{TAX_TP}
		</if>
		) AS Month_All
		FROM DOCRMT850
		LEFT JOIN (SELECT DOCRMT200.TAX_TP,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 1
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID IS NULL
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = #{DATE} THEN 0
		ELSE 0 END) AS RESULT_ID1,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 1
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID IS NULL
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = #{DATE} THEN 0
		ELSE 0 END) AS RESULT_ID2,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 1
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID IS NULL
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = #{DATE} THEN 0
		ELSE 0 END) AS RESULT_ID3,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 1
		WHEN DOCRMT720.RESULT_ID IS NULL AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) =
		#{DATE} THEN 0
		ELSE 0 END) AS RESULT_ID4,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID IS NULL AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) =
		#{DATE} THEN 1
		ELSE 0 END) AS RESULT_ID5,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 1
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		ELSE 0 END) AS RESULT_ID6,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 1
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		ELSE 0 END) AS RESULT_ID7,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 1
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		ELSE 0 END) AS RESULT_ID8,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 1
		ELSE 0 END) AS RESULT_ID9
		FROM DOCRMT200
		LEFT JOIN DOCRMT720 ON DOCRMT200.DOCRM_NO = DOCRMT720.DOCRM_NO
		AND SUBSTR(DOCRMT720.RESPOND_DATE, 1, 5) = #{DATE}
		<if test="QUESTION_ID != null and QUESTION_ID != ''">
			AND DOCRMT720.QUESTION_ID = #{QUESTION_ID}
		</if>
		<if test="DOC_ORG_ID != null and DOC_ORG_ID != ''">
			AND DOCRMT200.ACP_CD = #{DOC_ORG_ID}
		</if>
		) DOCRMT200 ON DOCRMT850.PHRASE_KEY = DOCRMT200.TAX_TP
		WHERE DOCRMT850.PHRASE_TYPE_KEY = 'TAX_TP'
		<if test="TAX_TP != null and TAX_TP != ''">
			AND DOCRMT850.PHRASE_KEY = #{TAX_TP}
		</if>
		GROUP BY PHRASE_TITLE
		UNION ALL
		SELECT
		'共計',
		(SELECT COUNT(*)
		FROM DOCRMT200 A
		LEFT JOIN DOCRMT850
		ON DOCRMT850.PHRASE_KEY = A.TAX_TP
		LEFT JOIN docrmt720
		ON DOCRMT720.DOCRM_NO = A.DOCRM_NO
		WHERE
		SUBSTR(A.CPL_DATE, 1, 5) = #{DATE}
		AND A.TAX_TP=DOCRMT200.TAX_TP
		<if test="DOC_ORG_ID != null and DOC_ORG_ID != ''">
			AND A.ACP_CD = #{DOC_ORG_ID}
		</if>
		<if test="TAX_TP != null and TAX_TP != ''">
			AND DOCRMT850.PHRASE_KEY = #{TAX_TP}
		</if>
		<if test="QUESTION_ID != null and QUESTION_ID != ''">
			AND DOCRMT720.QUESTION_ID = #{QUESTION_ID}
		</if>
		) AS Month_End,
		SUM(IFNULL(RESULT_ID1,0)) AS Month1,
		SUM(IFNULL(RESULT_ID2,0)) AS Month2,
		SUM(IFNULL(RESULT_ID3,0)) AS Month3,
		SUM(IFNULL(RESULT_ID4,0)) AS Month4,
		SUM(IFNULL(RESULT_ID5,0)) AS Month_Zero,
		SUM(IFNULL(RESULT_ID6,0)) AS Next_Month1,
		SUM(IFNULL(RESULT_ID7,0)) AS Next_Month2,
		SUM(IFNULL(RESULT_ID8,0)) AS Next_Month3,
		SUM(IFNULL(RESULT_ID9,0)) AS Next_Month4,
		(SELECT COUNT(*)
		FROM DOCRMT720, DOCRMT200 ,DOCRMT700
		WHERE DOCRMT720.DOCRM_NO = DOCRMT200.DOCRM_NO
		AND DOCRMT850.PHRASE_KEY = DOCRMT200.TAX_TP
		AND SUBSTR(DOCRMT720.RESPOND_DATE, 1, 5) = #{DATE}
		AND DOCRMT700.QUESTION_ID = docrmt720.QUESTION_ID
		<if test="QUESTION_ID != null and QUESTION_ID != ''">
			AND DOCRMT720.QUESTION_ID = #{QUESTION_ID}
		</if>
		<if test="DOC_ORG_ID != null and DOC_ORG_ID != ''">
			AND DOCRMT200.ACP_CD = #{DOC_ORG_ID}
		</if>
		<if test="TAX_TP != null and TAX_TP != ''">
			AND DOCRMT850.PHRASE_KEY = #{TAX_TP}
		</if>
		) AS Month_All
		FROM DOCRMT850
		LEFT JOIN (SELECT DOCRMT200.TAX_TP,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 1
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID IS NULL AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) =
		#{DATE} THEN 0
		ELSE 0 END) AS RESULT_ID1,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 1
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID IS NULL
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = #{DATE} THEN 0
		ELSE 0 END) AS RESULT_ID2,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 1
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID IS NULL
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = #{DATE} THEN 0
		ELSE 0 END) AS RESULT_ID3,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3 AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) =
		SUBSTR(DOCRMT720.RESPOND_DATE, 1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4 AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) =
		SUBSTR(DOCRMT720.RESPOND_DATE, 1, 5) THEN 1
		WHEN DOCRMT720.RESULT_ID IS NULL
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = #{DATE} THEN 0
		ELSE 0 END) AS RESULT_ID4,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) = SUBSTR(DOCRMT720.RESPOND_DATE, 1,
		5) THEN 0
		WHEN DOCRMT720.RESULT_ID IS NULL AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) =
		#{DATE} THEN 1
		ELSE 0 END) AS RESULT_ID5,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 1
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		ELSE 0 END) AS RESULT_ID6,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 1
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		ELSE 0 END) AS RESULT_ID7,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 1
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		ELSE 0 END) AS RESULT_ID8,
		(CASE WHEN DOCRMT720.RESULT_ID=1
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=2
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=3
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 0
		WHEN DOCRMT720.RESULT_ID=4
		AND SUBSTR(DOCRMT200.CPL_DATE, 1, 5) &lt; SUBSTR(DOCRMT720.RESPOND_DATE,
		1, 5) THEN 1
		ELSE 0 END) AS RESULT_ID9
		FROM DOCRMT200
		LEFT JOIN DOCRMT720
		ON DOCRMT200.DOCRM_NO = DOCRMT720.DOCRM_NO
		AND SUBSTR(DOCRMT720.RESPOND_DATE, 1, 5) = #{DATE}
		<if test="QUESTION_ID != null and QUESTION_ID != ''">
			AND DOCRMT720.QUESTION_ID = #{QUESTION_ID}
		</if>
		<if test="DOC_ORG_ID != null and DOC_ORG_ID != ''">
			AND DOCRMT200.ACP_CD = #{DOC_ORG_ID}
		</if>
		) DOCRMT200 ON DOCRMT850.PHRASE_KEY = DOCRMT200.TAX_TP
		WHERE DOCRMT850.PHRASE_TYPE_KEY = 'TAX_TP'
		<if test="TAX_TP != null and TAX_TP != ''">
			AND DOCRMT850.PHRASE_KEY = #{TAX_TP}
		</if>

	</select>

	<!-- 取查詢條件中文名稱 -->
	<select id="queryQUESTION" parameterType="HashMap" resultType="HashMap">
		SELECT docrmt700.QUESTION,
		docrmt700.QUESTION_ID
		FROM docrmt700
		LEFT JOIN DOCRMT720
		ON DOCRMT720.QUESTION_ID = docrmt700.QUESTION_ID
		<where>
			<if test="QUESTION_ID != null and QUESTION_ID != ''">
				AND docrmt700.QUESTION_ID = #{QUESTION_ID}
			</if>
		</where>

	</select>

	<!-- 取查詢條件中文名稱 -->
	<select id="queryT850TAX_TP" parameterType="HashMap" resultType="HashMap">
		SELECT
		PHRASE_KEY,
		PHRASE_TITLE AS TAX_TP
		FROM docrmt850
		<where>
			PHRASE_TYPE_KEY = 'TAX_TP'
			<if test="TAX_TP != null and TAX_TP != ''">AND PHRASE_KEY = #{TAX_TP} </if>
		</where>

	</select>

	<!-- 取查詢條件中文名稱 -->
	<select id="queryT850ORG_ID" parameterType="HashMap" resultType="HashMap">
		SELECT
		PHRASE_KEY,
		PHRASE_TITLE AS ORG_ID
		FROM docrmt850
		<where>
			PHRASE_TYPE_KEY = 'ORG_ID'
			<if test="DOC_ORG_ID != null and DOC_ORG_ID != ''">
				and PHRASE_KEY = #{DOC_ORG_ID}
			</if>
		</where>

	</select>
	
	
	<!-- 取題目的中文名稱 -->
	<select id="queryT710_RESULT" parameterType="HashMap" resultType="HashMap">
		SELECT 
			QUESTION_ID,
			RESULT,
			RESULT_ID
		FROM DOCRMT710
		WHERE QUESTION_ID=#{QUESTION_ID}

		
	</select>
	
	<!-- 答案下拉式選單 -->
	<select id="queryT710_QA" parameterType="HashMap" resultType="HashMap">
	SELECT
		docrmt710.RESULT AS TEXT,
		docrmt710.RESULT_ID AS VALUE
	FROM DOCRMT710
	INNER JOIN DOCRMT700 
	ON DOCRMT700.QUESTION_ID = DOCRMT710.QUESTION_ID
	WHERE
	docrmt710.QUESTION_ID=#{QUESTION_ID}
</select>

</mapper>
